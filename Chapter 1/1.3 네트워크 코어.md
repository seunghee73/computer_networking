## 1.3 네트워크 코어

* 링크와 스위치의 네트워크를 통해 데이터를 이동시키는 방식에는 회선 교환(circuit switching)과 패킷 교환(packet switching)이라는 두 가지 기본 방식이 있다.

### 1.3.1 패킷 교환
* 패킷은 링크의 최대 전송 속도와 같은 속도로 각각의 통신 링크 상에서 전송된다. 
* 송신 종단 시스템 혹은 패킷 스위치가 ***R*** bit/sec의 속도로 링크상에서 ***L*** bits의 패킷을 송신한다면, 그 패킷을 전송하는데 걸리는 시간은 ***L/R*** sec이다. 
* 저장 후 전달 전송 (store-and-forward transmission)
  * 라우터는 수신한 비트를 바로 전송할 수 없고, 패킷의 비트를 먼저 버퍼에 저장(store)하고, 라우터가 패킷의 모든 비트를 수신한 후에만 출력 링크로 패킷을 전송(forward)하기 시작한다.
  * 소스(source)가 첫 번째 패킷을 송신하기 시작한 순간부터 목적지(destination) 노드가 3개의 패킷을 수신할 때까지 경과된 전체 시간 계산
    * ***L/R*** 시간에 라우터는 첫 번째 패킷을 전송하기 시작, 소스에서는 두 번째 패킷을 송신하기 시작
    * ***2L/R*** 시간에 목적지 노드는 첫 번째 패킷을 수신하게 되고 라우터는 두 번째 패킷을 수신
    * ***3L/R*** 시간에 목적지 노드는 두 번째 패킷을 수신하게 되고 라우터는 세 번째 패킷을 수신
    * ***4L/R*** 시간에 목적지 노드는 모든 패킷 수신
  * 소스로부터 목적지까지 N개 링크로 구성되고, 각각 R의 전송속도를 갖는 경로를 통해 하나의 패킷을 전송하는 경우 (소스와 목적지 사이에 N-1개의 라우터) 
$$
d_{종단간 지연} = N\frac{L}{R}
$$
* 큐잉 지연(queuing delay)과 패킷 손실(packet loss)
  * 패킷 스위치는 접속딘 여러 개의 링크를 가지고 있고 각 링크에 대해서 출력 버퍼(출력 큐)를 가지고 있다.
  * 도착한 패킷이 전송되어야하는 링크에 이미 다른 패킷이 전송되고 있다면 도착한 패킷은 출력 버퍼에서 대기
  * 큐잉 지연은 가변적이고 네트워크 혼잡도에 의존적
  * 버퍼 공간이 유한하기 때문에 버퍼가 가득찬 상황에 패킷 도착하게 되면, 도착한 패킷 혹은 이미 큐에 대기 중인 패킷이 폐기(drop)당할 수 있는데 이를 패킷 손실이라고 한다.
* 전달 테이블과 라우팅 프로토콜
  * 모든 종단 시스템은 IP 주소라고 하는 주소를 갖는다.
  * 소스 종단 시스템이 패킷을 목적지 종단 시스템으로 보내고자 할 때, 소스는 패킷의 헤더에 목적지의 IP 주소 포함
  * IP 주소는 계층적 구조이고 각 라우터는 목적지 주소를 라우터의 출력 링크로 맵핑하는 전달 테이블(forward table)을 갖고 있다.

### 1.3.2 회선 교환

* 회선 교환 네트워크에서 종단 시스템 간에 통신을 제공하기 위해 경로상에 필요한 자원(버퍼, 링크, 전송률)은 통신 세션 동안에 확보 또는 예약된다. (패킷 교환 네트워크에서는 자원을 미리 예약하지 않는다.)
* 세션 메시지는 온디멘드(on-demand, 요구 시 즉시 제공/공급) 방식으로 자원을 요청하여 사용하고 그 결과, 통신 링크에 대한 접속을 위해 큐에서 대기할 수도 있다.
* 대표적인 예시로 전화망이 있다
  * 송신자와 수신자 간의 연결을 설정해야 한다.
    * 회선(circuit) : 송신자와 수신자 간의 경로에 있는 스위치들이 해당 연결 상태를 유지해야 하는 연결
    * 연결이 이루어지는 동안 네트워크 링크에 일정한 전송률을 예약 
* 회선 교환 네트워크에서의 다중화
  * 주파수 분할 다중화(FDM, frequency-division multiplexing)
  
    * 링크의 주파수 스펙트럼 공유, 연결되는 동안 각 연결에 대해 고정 주파수 대역을 제공
    * 주파수 대역의 폭을 대역폭(bandwidth)라고 한다.
  
  * 시간 분할 다중화(TDM, time-division multiplexing)
  
    * 시간을 일정 주기의 프레임으로 구분, 각 프레임은 고정된 수의 시간 슬롯으로 나뉘어짐
  
    * 네트워크가 링크를 통해 하나의 연결을 설정할 때, 모든 프레임에서 시간 슬롯 1개를 해당 연결에 할당
  
    * 전송률은 한 슬롯 안의 비트 수에 프레임 전송률을 곱한 것 과 같다.
  
      * 링크가 초당 8,000 프레임을 전송하고, 각 슬롯이 8비트로 구성된다면 회선의 전송률은 64kbps
* 패킷 교환 대 회선 교환
  * 회선 교환이 요구에 관계없이 미리 전송 링크의 사용을 할당하는 반면에 패킷 교환은 요구할 때만 링크의 사용을 할당한다는 것이 가장 큰 차이점
  * 패킷 교환은 가변적이고 예측할 수 없는 종단간의 지연(주로 불규칙적이고 예측할 수 없는 큐잉 지연에 의한)이 발생한다는 단점이 있지만 간단하고 효율적이며 회선 교환보다 구현 비용이 적다는 장점이 있다.

  * 회선 교환은 할당된 회선이 비활용 기간(silent period)에는 놀게 되는 문제가 있다.
  * 대부분 패킷 교환으로 바뀌고 있는 추세

### 1.3.3 네트워크의 네트워크
* 종단 시스템들은 접속 ISP로 연결되어야 하고 접속 ISP 역시도 서로서로 연결되어 있어야한다.

* 이를 위해 네트워크의 네트워크가 탄생

* 중요한 목표는 모든 종단 시스템이 서로에게 패킷을 보낼 수 있도록 접속 ISP를 연결

  

